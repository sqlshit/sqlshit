#!/usr/bin/env sh
set -eu
# dev launcher: run src/main.sh with dev flags; never builds

export SHIT_DEV=1
: "${SHIT_LOG:=debug}"

cd "$(git rev-parse --show-toplevel 2>/dev/null || pwd)"

# derive version string from VERSION file
SQLSHIT_VERSION="$(cat VERSION 2>/dev/null || printf '0.0.0')-dev"
export SQLSHIT_VERSION

# run entry
if [ ! -f "src/main.sh" ]; then
  printf '%s\n' "error: src/main.sh missing. create it or run ./build.sh first."
  exit 1
fi

chmod +x src/main.sh
exec ./src/main.sh "$@"